#include <stdio.h>
#include <stdlib.h>

struct node {
    int data;
    struct node *prev, *next;
};

struct node *head = NULL;

void insert_first(int x) {
    struct node *t = malloc(sizeof(struct node));
    t->data = x;
    t->prev = NULL;
    t->next = head;
    if(head) head->prev = t;
    head = t;
}

void insert_last(int x) {
    struct node *t = malloc(sizeof(struct node));
    t->data = x;
    t->next = NULL;
    if(head == NULL) {
        t->prev = NULL;
        head = t;
        return;
    }
    struct node *p = head;
    while(p->next) p = p->next;
    p->next = t;
    t->prev = p;
}

void insert_after(int key, int x) {
    struct node *p = head;
    while(p && p->data != key) p = p->next;
    if(!p) return;
    struct node *t = malloc(sizeof(struct node));
    t->data = x;
    t->next = p->next;
    t->prev = p;
    if(p->next) p->next->prev = t;
    p->next = t;
}

void delete_node(int key) {
    struct node *p = head;
    while(p && p->data != key) p = p->next;
    if(!p) return;
    if(p->prev) p->prev->next = p->next;
    else head = p->next;
    if(p->next) p->next->prev = p->prev;
    free(p);
}

int search(int key) {
    struct node *p = head;
    int pos = 1;
    while(p) {
        if(p->data == key) return pos;
        p = p->next;
        pos++;
    }
    return -1;
}

void display() {
    struct node *p = head;
    while(p) {
        printf("%d ", p->data);
        p = p->next;
    }
}

int main() {
    int ch, x, key;
    while(1) {
        scanf("%d", &ch);
        if(ch == 1) {
            scanf("%d", &x);
            insert_first(x);
        } else if(ch == 2) {
            scanf("%d", &x);
            insert_last(x);
        } else if(ch == 3) {
            scanf("%d %d", &key, &x);
            insert_after(key, x);
        } else if(ch == 4) {
            scanf("%d", &key);
            delete_node(key);
        } else if(ch == 5) {
            scanf("%d", &key);
            printf("%d\n", search(key));
        } else if(ch == 6) {
            display();
        } else break;
    }
}
